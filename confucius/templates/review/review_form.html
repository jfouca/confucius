{% extends "base-in.html" %}
{% load url from future %}

{% block title %}Review{% endblock %}
{% load extra %}

{% block content_header %}
<h1>
    {% if instance %}
        Edit review
    {% else %}
        Submit review
    {% endif %}
</h1><br/>
{% endblock %}

{% block content_main %}

<p>Title : {{assignment.paper.title}}</p>
<p>Conference : {{assignment.paper.conference.title}}</p>
<p>Domains : {{assignment.paper.domains.all|join:', '}}</p>
<p>Language : {{assignment.paper.title}}</p>
<p><a href="{{assignment.paper.file.url}}" class="btn btn-primary">Download the paper</a></p>
<p><a href="{%Â url 'problem' conference.pk assignment.pk %}" class="btn">Notify chair of a problem with this paper</a></p>

<form id="form" class="form-horizontal" method="post">
    {% csrf_token %}

    {% include 'includes/form.html' %}

    <div class="control-group">
        <label class="control-label">Overall evaluation:</label>
        <div class="controls">
            Rating: <span id="overall_evaluation-label"></span>
            <div id="overall_evaluations_stars">
                <select name="overall_evaluations_select" id="overall_evaluations_rate">
                    {% for i in conference.maximum_score|get_range %}
                        <option value="{{ i }}">{{ i }}/{{ conference.maximum_score }}</option>
                    {% endfor %}
                        <option value="{{conference.maximum_score}}">{{conference.maximum_score}}/{{conference.maximum_score}}</option>
                </select>
                <input type="hidden" name="overall_evaluations" id="overall_evaluations" value="{{initial_overall_evaluation}}"/>
            </div>
        </div>
    </div>


    <div class="form-actions">
        {% if conference.are_reviews_over or conference.are_reviews_over %}
            {% include 'includes/reviews_over_button.html' %}
        {% else %}
            {% if not assignment.is_done %}
                <input type="submit" name="save_and_continue" class="btn" value="Save review and continue later"/>
                <input type="submit" name="save_and_submit" class="btn btn-primary" value="Save and submit review"/>
            {% else %}
                <input type="submit" name="save" class="btn btn-primary" value="Update review"/>
            {% endif %}
        {% endif %} 
        <a href="{% url 'dashboard' %}" class="btn btn-info">
            <i class="icon-share-alt icon-white"></i> To dashboard
        </a>
    </div>
</form>


{% endblock %}

{% block script %}
<script src="{{ STATIC_URL }}star/jquery.ui.stars.js"></script>
<script src="{{ STATIC_URL }}star/jquery.ui.stars.min.js"></script>
<script>
    $("#overall_evaluations_stars").stars({
        captionEl: $("#overall_evaluation-label"),
        inputType: "select",
        callback: function(ui, type, value) {
            $("#overall_evaluations").attr("value", value);
        }
    });
    
    $("#overall_evaluations_stars").stars("select", {{initial_overall_evaluation}}); 
</script>
{% endblock %}

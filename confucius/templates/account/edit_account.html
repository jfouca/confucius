{% extends 'base-in.html' %}
{% load url from future %}

{% block title %}Account{% endblock %}

{% block content_header %}
<h1>Account
        <a href="{% url 'password_change' %}" class="btn btn-info">Change my password</a>
        {% if not user.is_superuser %}
            <a href="#" class="btn btn-danger" id="close_account">Close my account</a>
        {% endif %}
</h1>
{% endblock %}

{% block content_main %}
<form id="form" class="form-horizontal" method="post">{% csrf_token %}
    {% include 'includes/form.html' %}
    {% include 'includes/formset.html' with formset=email_formset %}
    {% include 'includes/formset.html' with formset=address_formset %}
</form>
<div class="modal hide fade" id="close_account_modal">
    <div class="modal-header">
        <a class="close" data-dismiss="modal">Ã—</a>
        <h3>Are you sure that you want to close your account?</h3>
    </div>
    <div class="modal-body">
        <p>Once your account is closed, only the platform administrator will be able to reopen it.</p>
    </div>
    <div class="modal-footer">
        <a href="{% url 'close_account' %}" class="btn btn-large btn-danger">Yes, I am</a>
        <a data-dismiss="modal" class="btn btn-large">No</a>
    </div>
</div>
{% endblock %}
{% block script %}
<script>
    $(function() {
        $('#id_trigger_date, #id_action, #id_event, #id_reminder').val('').closest('div.control-group').hide();
        $('#reminder').on('click', function() {
            $('#id_trigger_date, #id_action').val('').closest('div.control-group').hide();
            $('#id_reminder, #id_event').closest('div.control-group').show('slow');
        });
        $('#trigger').on('click', function() {
            $('#id_reminder, #id_action, #id_event').val('').closest('div.control-group').hide();
            $('#id_trigger_date').closest('div.control-group').show('slow');
        });
        $('#action').on('click', function() {
            $('#id_trigger_date, #id_reminder, #id_event').val('').closest('div.control-group').hide();
            $('#id_action').closest('div.control-group').show('slow');
        });
    });
</script>
{% endblock %}
